{"version":3,"file":"medix.umd.js","sources":["../src/medix.ts"],"sourcesContent":["export interface IHandler {\n  handle(command: IConstructable): IConstructable;\n}\n\nexport interface IRegisterHandler {\n  commandConstructor: Function;\n  responseConstructor: Function;\n  handler: IHandler;\n}\n\nexport interface IMediator {\n  register(data: IRegisterHandler): void;\n  send<T>(t: IConstructable, r: INewInstance<T>): T;\n}\n\nexport interface IConstructable {\n  constructor: Function;\n}\n\nexport interface INewInstance<T> extends IConstructable {\n  new(): T;\n}\n\nexport default class Mediator implements IMediator {\n  private registry: Map<Function, Map<Function, IHandler>> = new Map();\n  public register(data: IRegisterHandler) {\n    const responseMap = this.registry.get(data.commandConstructor);\n    if (responseMap) {\n      responseMap.set(data.responseConstructor, data.handler);\n      return;\n    }\n    const newResponseMap = new Map();\n    newResponseMap.set(data.responseConstructor, data.handler);\n    this.registry.set(data.commandConstructor, newResponseMap);\n\n  }\n  public send<T>(command: IConstructable, responseType: INewInstance<T>): T {\n    const responseMap = this.registry.get(command.constructor);\n    if (responseMap) {\n      const handler = responseMap.get(responseType);\n      if (handler) {\n        return handler.handle(command) as T;\n      }\n      throw new Error(\"No handler exists for this response type\");\n    }\n    throw new Error(\"No handler definitions for this command type\");\n  }\n}\n"],"names":[],"mappings":";;;;;;;IAuBA;QACU,aAAQ,GAA2C,IAAI,GAAG,EAAE,CAAC;KAuBtE;IAtBQ,QAAQ,CAAC,IAAsB;QACpC,MAAM,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;QAC/D,IAAI,WAAW,EAAE;YACf,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC,mBAAmB,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;YACxD,OAAO;SACR;QACD,MAAM,cAAc,GAAG,IAAI,GAAG,EAAE,CAAC;QACjC,cAAc,CAAC,GAAG,CAAC,IAAI,CAAC,mBAAmB,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;QAC3D,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,kBAAkB,EAAE,cAAc,CAAC,CAAC;KAE5D;IACM,IAAI,CAAI,OAAuB,EAAE,YAA6B;QACnE,MAAM,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;QAC3D,IAAI,WAAW,EAAE;YACf,MAAM,OAAO,GAAG,WAAW,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;YAC9C,IAAI,OAAO,EAAE;gBACX,OAAO,OAAO,CAAC,MAAM,CAAC,OAAO,CAAM,CAAC;aACrC;YACD,MAAM,IAAI,KAAK,CAAC,0CAA0C,CAAC,CAAC;SAC7D;QACD,MAAM,IAAI,KAAK,CAAC,8CAA8C,CAAC,CAAC;KACjE;CACF;;;;;;;;"}